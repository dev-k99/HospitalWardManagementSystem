@page
@model AuthModel
@{
    ViewData["Title"] = "Login / Register";
}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-6">
            <h3>Register</h3>
            <input id="rEmail" class="form-control mb-2" placeholder="Email" />
            <input id="rPassword" class="form-control mb-2" placeholder="Password" type="password" />
            <button id="register" class="btn btn-success">Register</button>
        </div>
        <div class="col-md-6">
            <h3>Login</h3>
            <input id="lEmail" class="form-control mb-2" placeholder="Email" />
            <input id="lPassword" class="form-control mb-2" placeholder="Password" type="password" />
            <button id="login" class="btn btn-primary">Login</button>
        </div>
    </div>
</div>

@section Scripts{
<script>
 document.getElementById('register').onclick = async () => {
    const res = await fetch('/api/auth/register', { method:'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email: rEmail.value, password: rPassword.value })});
    alert(res.ok ? 'Registered' : 'Failed');
 };
 document.getElementById('login').onclick = async () => {
    const res = await fetch('/api/auth/login', { method:'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email: lEmail.value, password: lPassword.value })});
    if(res.ok){ const { token } = await res.json(); localStorage.setItem('jwt', token); alert('Logged in'); } else { alert('Login failed'); }
 };
</script>
}
