@model IEnumerable<WardSystemProject.Models.Staff>

@{
    ViewData["Title"] = "Manage Staff";
}

<div class="container-fluid">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-md-8">
            <h2 class="text-primary">
                <i class="bi bi-people"></i> Manage Staff
            </h2>
            <p class="text-muted">Comprehensive staff management and administration</p>
        </div>
        <div class="col-md-4 text-end">
            <a asp-controller="StaffManagement" asp-action="CreateStaff" class="btn btn-success">
                <i class="bi bi-person-plus"></i> Add New Staff
            </a>
        </div>
    </div>

    <!-- Search and Filters -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow">
                <div class="card-header bg-info text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-search"></i> Search & Filters
                    </h6>
                </div>
                <div class="card-body">
                    <form asp-action="Search" method="get" class="row g-3">
                        <div class="col-md-3">
                            <label class="form-label">Search Term</label>
                            <input type="text" name="query" class="form-control" placeholder="Name, email, or role..." />
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">Role</label>
                            <select name="role" class="form-select">
                                <option value="">All Roles</option>
                                <option value="Doctor">Doctor</option>
                                <option value="Nurse">Nurse</option>
                                <option value="Nursing Sister">Nursing Sister</option>
                                <option value="Administrator">Administrator</option>
                                <option value="Ward Admin">Ward Admin</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">Status</label>
                            <select name="status" class="form-select">
                                <option value="">All Status</option>
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label">Department</label>
                            <select name="department" class="form-select">
                                <option value="">All Departments</option>
                                <option value="Medical">Medical</option>
                                <option value="Nursing">Nursing</option>
                                <option value="Administration">Administration</option>
                                <option value="Support">Support</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">&nbsp;</label>
                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-search"></i> Search
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Staff Statistics -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card bg-primary text-white">
                <div class="card-body text-center">
                    <i class="bi bi-people fs-1"></i>
                    <h4 class="card-title">@Model.Count()</h4>
                    <p class="card-text">Total Staff</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-success text-white">
                <div class="card-body text-center">
                    <i class="bi bi-person-check fs-1"></i>
                    <h4 class="card-title">@Model.Count(s => s.IsActive)</h4>
                    <p class="card-text">Active Staff</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-info text-white">
                <div class="card-body text-center">
                    <i class="bi bi-stethoscope fs-1"></i>
                    <h4 class="card-title">@Model.Count(s => s.Role == "Doctor")</h4>
                    <p class="card-text">Doctors</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-warning text-dark">
                <div class="card-body text-center">
                    <i class="bi bi-heart-pulse fs-1"></i>
                    <h4 class="card-title">@Model.Count(s => s.Role == "Nurse" || s.Role == "Nursing Sister")</h4>
                    <p class="card-text">Nurses</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Staff List -->
    <div class="row">
        <div class="col-12">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-list-ul"></i> Staff Directory
                    </h5>
                </div>
                <div class="card-body">
                    @if (Model.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-bordered table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Name</th>
                                        <th>Role</th>
                                        <th>Email</th>
                                        <th>Department</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var staff in Model)
                                    {
                                        <tr>
                                            <td>
                                                <strong>@staff.FullName</strong>
                                                <br><small class="text-muted">ID: @staff.Id</small>
                                            </td>
                                            <td>
                                                <span class="badge bg-@(staff.Role == "Doctor" ? "primary" : staff.Role == "Nurse" ? "success" : staff.Role == "Administrator" ? "danger" : "warning")">
                                                    @staff.Role
                                                </span>
                                            </td>
                                            <td>@staff.Email</td>
                                            <td>
                                                @{
                                                    var department = staff.Role switch
                                                    {
                                                        "Doctor" => "Medical",
                                                        "Nurse" or "Nursing Sister" => "Nursing",
                                                        "Administrator" => "Administration",
                                                        _ => "Support"
                                                    };
                                                }
                                                <span class="badge bg-info">@department</span>
                                            </td>
                                            <td>
                                                @if (staff.IsActive)
                                                {
                                                    <span class="badge bg-success">Active</span>
                                                }
                                                else
                                                {
                                                    <span class="badge bg-secondary">Inactive</span>
                                                }
                                            </td>
                                            <td>
                                                <div class="btn-group" role="group">
                                                    <a asp-controller="StaffManagement" asp-action="DetailsStaff" asp-route-id="@staff.Id" 
                                                       class="btn btn-sm btn-info" title="View Details">
                                                        <i class="bi bi-eye"></i>
                                                    </a>
                                                    <a asp-controller="StaffManagement" asp-action="EditStaff" asp-route-id="@staff.Id" 
                                                       class="btn btn-sm btn-warning" title="Edit">
                                                        <i class="bi bi-pencil"></i>
                                                    </a>
                                                    <a asp-controller="StaffManagement" asp-action="DeleteStaff" asp-route-id="@staff.Id" 
                                                       class="btn btn-sm btn-danger" title="Delete"
                                                       onclick="return confirm('Are you sure you want to delete this staff member?')">
                                                        <i class="bi bi-trash"></i>
                                                    </a>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="text-center py-4">
                            <i class="bi bi-people fs-1 text-muted"></i>
                            <h5 class="text-muted mt-3">No staff members found</h5>
                            <p class="text-muted">Try adjusting your search criteria or add new staff members.</p>
                            <a asp-controller="StaffManagement" asp-action="CreateStaff" class="btn btn-primary">
                                <i class="bi bi-person-plus"></i> Add First Staff Member
                            </a>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card shadow">
                <div class="card-header bg-secondary text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-lightning"></i> Quick Actions
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <a asp-controller="StaffManagement" asp-action="CreateStaff" class="btn btn-success w-100">
                                <i class="bi bi-person-plus"></i> Add New Staff
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a asp-controller="StaffManagement" asp-action="Index" class="btn btn-primary w-100">
                                <i class="bi bi-list"></i> View All Staff
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a asp-controller="StaffManagement" asp-action="Index" class="btn btn-info w-100">
                                <i class="bi bi-speedometer2"></i> Staff Dashboard
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <button class="btn btn-warning w-100" onclick="exportStaffData()">
                                <i class="bi bi-download"></i> Export Data
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function exportStaffData() {
            // Placeholder for export functionality
            alert('Export functionality coming soon!');
        }

        // Add some interactivity
        $(document).ready(function() {
            // Highlight active/inactive staff
            $('.badge.bg-success').closest('tr').addClass('table-success');
            $('.badge.bg-secondary').closest('tr').addClass('table-secondary');
            
            // Add hover effects
            $('tbody tr').hover(
                function() { $(this).addClass('table-hover'); },
                function() { $(this).removeClass('table-hover'); }
            );
        });
    </script>
}
